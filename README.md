# Домашнее задание к занятию "`Базы данных, их типы`" - `Рыбянцев Павел`


---

### Задание 1. СУБД

### Кейс
Крупная строительная компания, которая также занимается проектированием и девелопментом, решила создать 
правильную архитектуру для работы с данными. Ниже представлены задачи, которые необходимо решить для
каждой предметной области. 

Какие типы СУБД, на ваш взгляд, лучше всего подойдут для решения этих задач и почему? 
 
1.1. Бюджетирование проектов с дальнейшим формированием финансовых аналитических отчётов и прогнозирования рисков.
СУБД должна гарантировать целостность и чёткую структуру данных.
```
Для этого лучше использовать реляционные СУБД. 
Поддержка отношения между таблицами и обеспечение высокой надежности транзакций.

Например PostgreSQL:
Открытый исходный код, поддерживает ACID-транзакции, легко масштабируется горизонтально и вертикально.
Легкость и гибкость SQL.
Поддерживает расширенную функциональность для анализа больших объемов данных.
Легко интегрируется с инструментами бизнес-аналитики.
```

1.1.* Хеширование стало занимать длительно время, какое API можно использовать для ускорения работы? 

1.2. Под каждый девелоперский проект создаётся отдельный лендинг, и все данные по лидам стекаются в CRM к 
маркетологам и менеджерам по продажам. Какой тип СУБД лучше использовать для лендингов и для CRM? 
СУБД должны быть гибкими и быстрыми.
```
Тут подойдут NoSQL-решения, потому как они позволяют хранить несвязанные друг с другом сущности и эффективно обрабатывать большие объемы простых структурированных данных.

Например MongoDB:
Имеет документоориентированный характер, что подходит для лендингов и CRM
Подходит для динамических приложений типа лендинга и CRM.
```

1.2.* Можно ли эту задачу закрыть одной СУБД? И если да, то какой именно СУБД и какой реализацией?
```
Похоже что да, MongoDB обладает достаточной гибкостью и скоростью для хранения как небольших сущностей (лендинговые страницы), так и достаточно крупных массивов данных (CRM-лиды). Хранит данные в гибком формате, похожем на JSON (формат BSON), в виде коллекций и документов.
```

1.3. Отдел контроля качества решил создать базу по корпоративным нормам и правилам, обучающему материалу 
и так далее, сформированную согласно структуре компании. СУБД должна иметь простую и понятную структуру.
```
Так как требуется структурировать данные, то более подходящим решением выглядит реляционные СУБД, тот же PostgreSQL. В любом случае для удобства пользователя потребуется отдельный интерфейс. Например тот же Confluence, который в свою очередь будет будет хранить данные в PostgreSQL.
```
1.3.* Можно ли под эту задачу использовать уже существующую СУБД из задач выше и если да, то как лучше это 
реализовать?
```
Да, можно в СУБД PostgreSQL создаем отдельню БД под этот проект. Физически можно и в уже существующей бд сделать отдельную схему под это, но это не лучший вариант.
```

1.4. Департамент логистики нуждается в решении задач по быстрому формированию маршрутов доставки материалов 
по объектам и распределению курьеров по маршрутам с доставкой документов. СУБД должна уметь быстро работать
со связями.
```
Под эти задачи больше подходит графовая БД, поддерживающая обработку графов и пространственных данных.

Например Neo4j:
 Графовая СУБД, оптимизированная для обработки сетевых структур и связи узлов.

 Либо PostGIS: 
 Расширение PostgreSQL для геопространственного анализа и работы с географическими координатами.
```

1.4.* Можно ли к этой СУБД подключить отдел закупок или для них лучше сформировать свою СУБД в связке с СУБД 
логистов?
```
Связывание отделов логистики и закупок возможно внутри единой СУБД, если логика взаимодействия проста и прозрачна. Например, можно использовать PostgreSQL + PostGIS совместно с модулем синхронизации данных. Но оптимальным вариантом остается отдельная СУБД для отдела закупок, интегрированная с системой логистики через API-интерфейсы. Таким образом можно избежать проблем производительности и конфликта операций.
```

1.5.* Можно ли все перечисленные выше задачи решить, используя одну СУБД? Если да, то какую именно?
```
Теоретически все задачи можно решить одной универсальной СУБД (например PostgreSQL), однако это приведет к снижению общей производительности и усложнению архитектуры. Каждая задача требует специфичного подхода к хранению и обработке данных, и попытка объединить их в единую систему создаст трудности с администрированием и масштабируемостью.
```

---

### Задание 2. Транзакции

2.1. Пользователь пополняет баланс счёта телефона, распишите пошагово, какие действия должны произойти для того, чтобы 
транзакция завершилась успешно. Ориентируйтесь на шесть действий.
```
-- Начинаем транзакцию с уровнем изоляции SERIALIZABLE(обеспечит максимальную согласованность данных) 
BEGIN TRANSACTION ISOLATION LEVEL SERIALIZABLE;

-- Проверяем существование абонента и номер телефона
SELECT id FROM users WHERE phone_number = 'НомерТелефона';
IF NOT FOUND THEN
    RAISE EXCEPTION 'Пользователь с указанным номером телефона не найден.';
END IF;

-- Авторизация и проверка суммы пополнения
SELECT balance INTO current_balance FROM accounts WHERE user_id = user_id;
IF current_balance + amount_to_recharge > max_allowed_balance THEN
    RAISE EXCEPTION 'Превышен максимальный разрешенный баланс.';
END IF;

-- Запускаем операцию пополнения
UPDATE accounts SET balance = balance + amount_to_recharge WHERE user_id = user_id;

-- Регистрация транзакции в журнале операций
INSERT INTO transactions (user_id, transaction_type, amount, timestamp)
VALUES (user_id, 'Пополнение', amount_to_recharge, NOW());

-- Завершаем транзакцию, применяя все выполненные изменения в базу данных.
COMMIT;
```

2.1.* Какие действия должны произойти, если пополнение счёта телефона происходило бы через автоплатёж?

---

### Задание 3. SQL vs NoSQL

3.1. Напишите пять преимуществ SQL-систем по отношению к NoSQL. 
```
1. Строгая структура данных
   Данные хранятся в реляционных таблицах с заранее определённой структурой полей и типов данных, что обеспечивает целостность и согласованность информации.

2. Поддержка ACID-транзакций
   Транзакционная безопасность обеспечивается благодаря поддержке транзакций с характеристиками Atomicity (атомарность), Consistency (целостность), Isolation (изоляция) и Durability (долговечность).

3. Высокая надёжность хранения данных
   Благодаря строгой структуре и механизму контроля целостности, вероятность потери данных значительно ниже по сравнению с NoSQL системами.

4. Простота управления и поддержка стандартов
   SQL-запросы интуитивно понятны и стандартизированы, что упрощает разработку приложений и миграцию между различными платформами.

5. Возможность сложных запросов и анализа данных
   Мощные возможности SQL позволяют создавать сложные запросы с агрегациями, сортировками, фильтрами и объединениями таблиц, обеспечивая гибкость при обработке больших объёмов структурированных данных.
```

3.1.* Какие, на ваш взгляд, преимущества у NewSQL систем перед SQL и NoSQL.

---

### Задание 4. Кластеры

Необходимо производить большое количество вычислений при работе с огромным количеством данных, под эту задачу 
выделено 1000 машин. 

На основе какого критерия будете выбирать тип СУБД и какая модель *распределённых вычислений* 
здесь справится лучше всего и почему?
```
Нужно сделать выбор на основе теоремы CAP.
Из задания следует, что требуется система с хорошей поддержкой маштабируемости + большим количеством вычислений + большое количество данных (к сожалению нет информации о их структуре, поэтому будем считать что данные простые но их много)

Соответсвенно нужно выбирать между:
 AP (доступность и устойчивость к разделению) 
 CP (согласованность и устойчивость к разделению)
    

Можно предпочесть MongoDB за втроеную поддержку MapReduce (технология обработки огромных объемов данных 
(Big Data) путем распределения задач на сотни или тысячи узлов в кластере)

Так же можно к примеру использовать redis технологией Redis Search (Предоставляет мощный движок агрегации (Aggregation Pipeline),
который работает быстрее, чем MapReduce, за счет предварительной индексации данных)
```
*Приведите ответ в свободной форме.*

---

Задания,помеченные звёздочкой, — дополнительные, то есть не обязательные к выполнению, и никак не повлияют на получение вами зачёта по этому домашнему заданию. Вы можете их выполнить, если хотите глубже разобраться в материале.
